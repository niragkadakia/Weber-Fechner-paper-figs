\noindent \begin{minipage}{\linewidth } \includegraphics[width=\linewidth ]{figure2_supp1}\par \textbf {Figure 2--Figure supplement 1.}  t-SNE projections for non-adaptive ($\beta = 1$) and adaptive ($\beta = 0$) systems, when background firing rates depend on ORN identity. Background active fractions $A_{0a}$ are chosen normally with mean 0.1 and deviation 0.03, corresponding to background firing rates around of $\simeq $ 20-40 Hz. \par \vskip 8pt \end{minipage} \vskip 16pt 
\noindent \begin{minipage}{\linewidth } \includegraphics[width=0.85\linewidth ]{figure2_supp2}\par \textbf {Figure 2--Figure supplement 2.}  Front-end adaptive feedback preserves information capacity of the ORN sensing repertoire. \textbf {A} Mutual information between signal $\mathbf s(t)=\mathbf s_A(t)+\mathbf s_B(t)$ and response $\mathbf r(t)$ is calculated at various points in time $t$ for an odor environment consisting of two step odors, A and B. Odor A, with concentration $\mathbf s_A(t)$, turns on at time $t_A$ and a odor B, with concentration $\mathbf s_B(t)$, turns on at some later time $t_B$. Both odors have similar intensities $\sim s_0$ and similar molecular complexity ($k = 4$). \textbf {B} Mutual information as a function of $s_0$ for the non-adaptive system, respectively, at different time points after $t_A$, corresponding to the dots in A. The mutual information carried by distinct ORNs is represented by the shaded region; their average is plotted by the heavy line. In the non-adaptive system, the mutual information peaks in the regime of high sensitivity after the arrival of odor A (purple, blue), and shifts leftward with the onset of odor B (teal, green). The leftward shifts occurs since stronger signals are more prone to response saturation (compromising information transfer) as odor B arrives. \textbf {C} Same as \textbf {B}, now for the adaptive system. The MI mimics the non-adaptive case at the onset of odor A, before adaptation has kicked in (purple). As the system adapts and responses decrease toward baseline, previously saturating signal intensities now cross the regime of maximal sensitivity, which therefore shifts rightward to higher $s_0$ (dark blue). Much later, but before the arrival of odor B, the ORNs that responded now fire at a similar adapted firing rate $\sim 30$ Hz, irrespective of odor identity, so the mutual information drops to zero. However, having now adjusted its sensitivity to the presence of odor A, the system can respond appropriately to odor B: the MI at $t_B$ is nearly 6 bits across decades of concentration immediately following $t_B$ (green). \par \vskip 8pt \end{minipage} \vskip 16pt 
\noindent \begin{minipage}{\linewidth } \includegraphics[width=0.7\linewidth ]{figure3_supp1}\par \textbf {Figure 3--Figure supplement 1.} Decoding accuracy for system with ORN-dependent adaptive timescales $\tau _a$. \textbf {A} Distribution of timescales for all ORNs $a$ (purple dots). Here, $\tau _a \sim \tau 10^X$ where $\tau = 250$ ms as in the main text and $X \sim \mathcal N(0, 0.2)$. \textbf {B} Individual plots show the percent of accurately decoded odor whiffs (same fluctuating odor signal used in the main text) as a function of background odor intensity, for the non-adaptive (blue) and adaptive (red) systems, for different $\tau _M$ (line shades). Plots are arrayed by the complexity of the naturalistic signal (column-wise) and the complexity of the background odor (row-wise).\par \vskip 8pt \end{minipage} \vskip 16pt 
\noindent \begin{minipage}{\linewidth } \includegraphics[width=0.7\linewidth ]{figure3_supp2}\par \textbf {Figure 3--Figure supplement 2.}  Benefits conferred by Weber-Fechner adaptation remain for a broader distribution of baseline adapted activity levels $A_{0a}$, now assumed to be ORN-dependent and chosen from a normal distribution. \textbf {A} Distribution of $A_{0a}$. \textbf {B} Decoding accuracy of foreground odors in the presence of background odors.\par \vskip 8pt \end{minipage} \vskip 16pt 
\noindent \begin{minipage}{\linewidth } \includegraphics[width=0.7\linewidth ]{figure3_supp3}\par \textbf {Figure 3--Figure supplement 3.}  Benefits conferred by Weber-Fechner adaptation remain for 2 binding sites per receptor. This might conceivably occur in insect olfactory receptors, heterotetramers consisting of 4 Orco/Or subunits that gate a central ion channel pathway~\citep {orco_structure}. Plotted is the decoding accuracy of foreground odors in the presence of background odors.\par \vskip 8pt \end{minipage} \vskip 16pt 
\noindent \begin{minipage}{\linewidth } \includegraphics[width=\linewidth ]{figure3_supp4}\par \textbf {Figure 3--Figure supplement 4.}  Eigenvalue distribution of $\mathbf {D}_{\mathbf s}^T\mathbf {D}_{\mathbf s}$, where $\mathbf {D}_{\mathbf s}$ is a $m \times k$ submatrix of the column-normalized linearized ORN response matrix $\mathbf {D}$, evaluated at the linearization point $\mathbf s$. Note that $\mathbf s$ is $k$-sparse, but its components do not necessarily align with the $k$ columns chosen for the sub-matrix. Eigenvalues are calculated for the adaptive (orange) and non-adaptive (blue) systems, for 1000 randomly chosen linearization points $\mathbf s$ and submatrices. Plots are arranged for various odor sparsities (by row) and odor intensities (by column). The restricted isometry property is satisfied when the eigenvalues lie between 0 and 2 (black vertical line), and is more strongly satisfied the more centered the distribution is around unity. The increase in near-zero eigenvalues for the non-adaptive system at higher odor complexities and intensities (lower right plots) indicates the weaker fulfillment of the restricted isometry property for these signals, and leads to higher probability of failure in compressed sensing signal reconstruction.\par \vskip 8pt \end{minipage} \vskip 16pt 
\noindent \begin{minipage}{\linewidth } \includegraphics[width=\linewidth ]{figure3_supp5}\par \textbf {Figure 3--Figure supplement 5.}  Decoding of odor signals (no background odors) using the IHT algorithm~\citep {IHT, nonlin_CS} qualitatively reproduces the results from the main text, which used traditional CS with background linearization. In the adaptive case, IHT actually exhibits superior accuracy to traditional CS, though IHT demands more compute time. The results here show odor decoding accuracy for sparse odor signals of given complexity and intensity, averaged over 10 distinct identities. The iterative algorithm was initialized at $ \mathaccentV{hat}182{ \mathbf s} = \mathbf 0$ and run forward until $ \mathaccentV{hat}182{ \mathbf s}$ was stationary, or 10000 iterations were reached. Step size $\mu $ in Eq.~\ref {eq:IHT_NL} was set to $s_0/20$. At each step, the linearized response used in determining $\mathbf x_{i+1}$ ($\mathbf {D}_{\mathbf s_i}$ in Eq.~\ref {eq:IHT_NL}) was evaluated at the result of $i$th iteration, $\mathbf x_i$. IHT also requires an assumption on the number of components in the mixture (which defines $H_K(\cdot )$ in Eq.~\ref {eq:IHT_NL}); here, that was set to twice the actual sparsity of true signal.\par \vskip 8pt \end{minipage} \vskip 16pt 
\noindent \begin{minipage}{\linewidth } \includegraphics[width=0.6\linewidth ]{figure3_supp6}\par \textbf {Figure 3--Figure supplement 6.}  Distribution of whiff durations in naturalistic stimulus, compared to the theoretical prediction~\citep {celani}\par \vskip 8pt \end{minipage} \vskip 16pt 
\noindent \begin{minipage}{\linewidth } \includegraphics[width=0.8\textwidth ]{figure4_supp1}\par \textbf {Figure 4--Figure supplement 1.}  Additional results pertaining to the primacy coding hypothesis. \textbf {A} Percent of active ORNs required for 75\% accuracy of a steep sigmoidal odor step, as a function of odor step intensity and odor complexity. For low complexities, a primacy set of fewer ORNs may be sufficient to decode the full odor signal; for higher complexities, the entire ORN repertoire is required. \textbf {B} In the primacy coding hypothesis, the primacy set is realized sooner for stronger odor signals, so odors are decoded earlier in time, resulting in a perceptual time shift with increasing odor concentration ~\citep {primacy_coding}. We also find this shift in our compressed sensing decoding framework (right plot), which rises monotonically with step height for various odor complexities, in agreement with primacy coding. \textbf {C} The consistency of a primacy code across changes in background odor concentration, in a system with Weber Law adaptation. We calculate the primacy set for odor A (step odor; black) in the presence of either a weak, medium, or strong background (dotted lines; 1x, 10x, 100x a.u.), assuming the system has adapted its response to the background as described in the main text. Averaged across odor A identities, primacy sets for odor A when in the 1x background are nearly identical to those when odor A is in the 10x background (right plot; yellow). The same holds true when comparing the 1x and 100x backgrounds, for sufficiently large primacy order, above 8 or so right plot; purple). This indicates that Weber Law adaptation preserves primacy codes across disparate environmental conditions.\par \vskip 8pt \end{minipage} \vskip 16pt 
\noindent \begin{minipage}{\linewidth } \includegraphics[width=0.6\textwidth ]{figure5_supp1}\par \textbf {Figure 5--Figure supplement 1.}  Accuracy of binary classification by odor valence, for odors whose concentrations span a narrow range of concentrations (1 order of magnitude). Accuracy is plotted as a function of the number of distinct odor identities classified by the trained network, in systems with only ORN adaptation, only divisive normalization, both or neither. Decoding gains conferred by divisive normalization and/or ORN adaptation are much smaller than when odors span a much larger range of concentrations, as shown in the main text.\par \vskip 8pt \end{minipage} \vskip 16pt 
